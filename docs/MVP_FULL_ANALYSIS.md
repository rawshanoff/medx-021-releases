# üîç MedX MVP: –ü–æ–ª–Ω—ã–π –ê–Ω–∞–ª–∏–∑ –ü—Ä–æ–µ–∫—Ç–∞

> **–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** 3 —Ñ–µ–≤—Ä–∞–ª—è 2026  
> **–î–ª—è:** Cursor Agent  
> **–¶–µ–ª—å:** –ó–∞–ø—É—Å–∫ MVP ‚Äî –≤—Å—ë —á—Ç–æ –≤ –∫–æ–¥–µ –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å

---

## üìä –û–±–∑–æ—Ä –ü—Ä–æ–µ–∫—Ç–∞

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ | –°—Ç–∞—Ç—É—Å |
|-----------|------------|--------|
| **Backend** | FastAPI, SQLAlchemy 2.0, PostgreSQL | ‚úÖ –ì–æ—Ç–æ–≤ |
| **Frontend** | React 18, TypeScript, TailwindCSS | ‚úÖ –ì–æ—Ç–æ–≤ |
| **Desktop** | Electron | ‚ö†Ô∏è –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ |
| **–ë–î –ú–∏–≥—Ä–∞—Ü–∏–∏** | Alembic (21 –º–∏–≥—Ä–∞—Ü–∏—è) | ‚úÖ –ì–æ—Ç–æ–≤ |
| **i18n** | 3 —è–∑—ã–∫–∞ (RU/EN/UZ) | ‚úÖ –ì–æ—Ç–æ–≤ |
| **–¢–µ—Å—Ç—ã** | Pytest (5 —Ñ–∞–π–ª–æ–≤) | ‚ö†Ô∏è –ë–∞–∑–æ–≤—ã–π |

---

## ‚úÖ –ü–õ–Æ–°–´ (–ß—Ç–æ –•–æ—Ä–æ—à–æ)

### 1. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Backend ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê

```
‚úì 10 –º–æ–¥—É–ª–µ–π: auth, users, patients, doctors, appointments, 
             finance, reception, system, files, licenses
‚úì Async SQLAlchemy ‚Äî –≤—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
‚úì Pydantic schemas ‚Äî —Å—Ç—Ä–æ–≥–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
‚úì RBAC –Ω–∞ –≤—Å–µ—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞—Ö (5 —Ä–æ–ª–µ–π)
‚úì Soft Delete –≤–µ–∑–¥–µ ‚Äî –¥–∞–Ω–Ω—ã–µ –Ω–µ —Ç–µ—Ä—è—é—Ç—Å—è
‚úì –ê—É–¥–∏—Ç —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
```

### 2. –§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –ú–æ–¥—É–ª—å ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê

```
‚úì –°–º–µ–Ω—ã (Shift) ‚Äî –æ—Ç–∫—Ä—ã—Ç–∏–µ/–∑–∞–∫—Ä—ã—Ç–∏–µ –∫–∞—Å—Å—ã
‚úì –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Å 4 —Ç–∏–ø–∞–º–∏ –æ–ø–ª–∞—Ç—ã (Cash/Card/Transfer/Mixed)
‚úì –ê—Ç–æ–º–∞—Ä–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è totals (race-safe)
‚úì pg_advisory_xact_lock –¥–ª—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç–∏
‚úì –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ —Å–º–µ–Ω—ã
‚úì Idempotency key ‚Äî –∑–∞—â–∏—Ç–∞ –æ—Ç –¥—É–±–ª–µ–π
‚úì related_transaction_id ‚Äî —Å–≤—è–∑—å –≤–æ–∑–≤—Ä–∞—Ç–æ–≤
‚úì X/Z –æ—Ç—á—ë—Ç—ã
```

### 3. –†–µ–≥–∏—Å—Ç—Ä–∞—Ç—É—Ä–∞ –∏ –û—á–µ—Ä–µ–¥—å ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê

```
‚úì –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–º–µ—Ä–æ–≤ —Ç–∞–ª–æ–Ω–æ–≤ (A-001, B-001)
‚úì –ê—Ç–æ–º–∞—Ä–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å retry –ø—Ä–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞—Ö
‚úì –ü—Ä–∏–≤—è–∑–∫–∞ –∫ –≤—Ä–∞—á—É —á–µ—Ä–µ–∑ queue_prefix
‚úì –°—Ç–∞—Ç—É—Å—ã –æ—á–µ—Ä–µ–¥–∏ (waiting/inprogress/completed)
```

### 4. –ü–∞—Ü–∏–µ–Ω—Ç—ã –∏ –í—Ä–∞—á–∏ ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê

```
‚úì CRUD —Å soft delete
‚úì –ü–æ–∏—Å–∫ –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤ (—Ç–µ–ª–µ—Ñ–æ–Ω, –§–ò–û, –¥–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è)
‚úì –ò—Å—Ç–æ—Ä–∏—è –ø–æ—Å–µ—â–µ–Ω–∏–π –ø–∞—Ü–∏–µ–Ω—Ç–∞
‚úì –£—Å–ª—É–≥–∏ –≤—Ä–∞—á–µ–π —Å —Ü–µ–Ω–∞–º–∏
‚úì –ê—Ä—Ö–∏–≤ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
```

### 5. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å ‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ

```
‚úì JWT —Ç–æ–∫–µ–Ω—ã —Å exp/refresh
‚úì Bcrypt —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π
‚úì Rate limiting (slowapi)
‚úì CORS whitelist
‚úì –õ–∏—Ü–µ–Ω–∑–∏—Ä–æ–≤–∞–Ω–∏–µ (RS256 JWT)
‚úì require_roles –Ω–∞ –≤—Å–µ—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞—Ö
```

### 6. –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è ‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ

```
‚úì 317 —Å—Ç—Ä–æ–∫ —Ä—É—Å—Å–∫–æ–π –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏
‚úì –ê–Ω–≥–ª–∏–π—Å–∫–∏–π –∏ —É–∑–±–µ–∫—Å–∫–∏–π
‚úì useTranslation() –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö
```

### 7. –ü–µ—á–∞—Ç—å –ß–µ–∫–æ–≤ ‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ

```
‚úì 3 —à–∞–±–ª–æ–Ω–∞ (check-1, check-6, check-4-58)
‚úì 15+ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –≤–∏–¥–∏–º–æ—Å—Ç–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
‚úì QR –∫–æ–¥, –ª–æ–≥–æ—Ç–∏–ø
‚úì Silent –ø–µ—á–∞—Ç—å —á–µ—Ä–µ–∑ Electron
‚úì –ü–æ–¥–¥–µ—Ä–∂–∫–∞ 58mm –∏ 80mm –±—É–º–∞–≥–∏
```

### 8. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ ‚≠ê‚≠ê‚≠ê‚òÜ‚òÜ

```
‚úì test_appointments.py (6336 bytes)
‚úì test_doctors.py (5320 bytes)
‚úì test_finance.py (4408 bytes)
‚úì test_reception_queue.py (5434 bytes)
‚úì conftest.py ‚Äî —Ñ–∏–∫—Å—Ç—É—Ä—ã
```

---

## ‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–´ –î–õ–Ø MVP (–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ)

### üî¥ P0: –ë–ª–æ–∫–µ—Ä—ã –ó–∞–ø—É—Å–∫–∞

#### 1. ~~–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–µ—á–∞—Ç–∏ —Ç–æ–ª—å–∫–æ –≤ localStorage~~ ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û
```
–§–ê–ô–õ: frontend/src/utils/print.ts

–°–¢–ê–¢–£–°: ‚úÖ –£–ñ–ï –ò–°–ü–†–ê–í–õ–ï–ù–û!
- getPrintSettings() –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Å API: GET /system/settings/print_config  
- setPrintSettings() —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —á–µ—Ä–µ–∑ API: PUT /system/settings/print_config
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ë–î, –Ω–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
```

---

#### 2. –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç (mock)
```
–§–ê–ô–õ: backend/modules/system/router.py

–ü–†–û–ë–õ–ï–ú–ê:
‚ùå GET /api/system/update-check –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
‚ùå –ö–Ω–æ–ø–∫–∞ "–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ" –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç

–í–õ–ò–Ø–ù–ò–ï –ù–ê MVP:
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ —Å–º–æ–≥—É—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è —á–µ—Ä–µ–∑ UI
- –ü—Ä–∏–¥—ë—Ç—Å—è –æ–±–Ω–æ–≤–ª—è—Ç—å –≤—Ä—É—á–Ω—É—é

–†–ï–®–ï–ù–ò–ï (–¥–ª—è MVP):
- –û—Ç–∫–ª—é—á–∏—Ç—å –∫–Ω–æ–ø–∫—É "–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å" 
- –ü–æ–∫–∞–∑–∞—Ç—å: "–°–≤—è–∂–∏—Ç–µ—Å—å —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è"
```

---

#### 3. ~~–ù–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ localStorage~~ ‚úÖ –ù–ï –ê–ö–¢–£–ê–õ–¨–ù–û
```
–°–¢–ê–¢–£–°: ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–µ–ø–µ—Ä—å —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ API!
- setPrintSettings() –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ –æ—à–∏–±–∫–µ API
- –§—Ä–æ–Ω—Ç–µ–Ω–¥ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç toast –ø—Ä–∏ –æ—à–∏–±–∫–µ
```

---

### üü° P1: –í–∞–∂–Ω—ã–µ –î–æ—Ä–∞–±–æ—Ç–∫–∏

#### 4. ~~Recent transactions –Ω–µ —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç deleted~~ ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û
```
–§–ê–ô–õ: backend/modules/finance/router.py

–°–¢–ê–¢–£–°: ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω —Ñ–∏–ª—å—Ç—Ä deleted_at.is_(None) –≤ –æ–±–∞ –∑–∞–ø—Ä–æ—Å–∞
```

---

#### 5. ~~–•–∞—Ä–¥–∫–æ–¥ —Ä—É—Å—Å–∫–∏—Ö —Å—Ç—Ä–æ–∫~~ ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û
```
–§–ê–ô–õ: System.tsx

–°–¢–ê–¢–£–°: ‚úÖ –ó–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ i18n:
- t('system.failed_check_updates')
- t('system.license_load_failed')
- t('system.user_created')
- t('system.user_create_failed')
- t('system.user_deleted')
- t('system.user_delete_failed')
- t('system.update_installation_todo')
```

---

#### 6. ~~–õ–∏–º–∏—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω~~ ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û
```
–§–ê–ô–õ: backend/core/config.py

–°–¢–ê–¢–£–°: ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –≤ config.py:
MAX_TRANSACTION_AMOUNT: int = 10_000_000

–¢–∞–∫–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ .env.example
```

---

#### 7. ~~Reception –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –≤—Ä–∞—á–∞~~ ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û
```
–§–ê–ô–õ: backend/modules/reception/router.py

–°–¢–ê–¢–£–°: ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è:
- –í—Ä–∞—á –¥–æ–ª–∂–µ–Ω —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å (Doctor.id)
- –í—Ä–∞—á –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∞–∫—Ç–∏–≤–µ–Ω (is_active == True)  
- –í—Ä–∞—á –Ω–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–¥–∞–ª—ë–Ω (deleted_at.is_(None))
- –û—á–µ—Ä–µ–¥—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏–µ –∑–∞–ø–∏—Å–∏
- –û—Ç–º–µ–Ω—ë–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è
```

---

### üü¢ P2: –£–ª—É—á—à–µ–Ω–∏—è (–ü–æ—Å–ª–µ MVP)

| # | –ü—Ä–æ–±–ª–µ–º–∞ | –†–µ—à–µ–Ω–∏–µ |
|---|----------|---------|
| 8 | –ù–µ—Ç —á–∞—Å—Ç–∏—á–Ω—ã—Ö –≤–æ–∑–≤—Ä–∞—Ç–æ–≤ | –î–æ–±–∞–≤–∏—Ç—å `refund_amount` –≤ RefundCreate |
| 9 | –ù–µ—Ç –∫–æ—Ä–∑–∏–Ω—ã —É—Å–ª—É–≥ | –û–ø–ª–∞—Ç–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —É—Å–ª—É–≥ –æ–¥–Ω–∏–º —á–µ–∫–æ–º |
| 10 | Telegram –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –Ω–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞ | E2E —Ç–µ—Å—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–∞–π–ª–æ–≤ |
| 11 | –ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ URL –¥–ª—è QR | Regex –ø—Ä–æ–≤–µ—Ä–∫–∞ https:// |
| 12 | –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–∑–º–µ—Ä–∞ –ª–æ–≥–æ—Ç–∏–ø–∞ | Max 512KB –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ |

---

## üìà –ü–æ–∫—Ä—ã—Ç–∏–µ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

### Backend API Endpoints

| –ú–æ–¥—É–ª—å | Endpoints | –¢–µ—Å—Ç—ã | –°—Ç–∞—Ç—É—Å |
|--------|-----------|-------|--------|
| Auth | 2 | ‚ùå | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| Users | 5 | ‚ùå | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| Patients | 8 | ‚ùå | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| Doctors | 9 | ‚úÖ | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| Appointments | 4 | ‚úÖ | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| Finance | 9 | ‚úÖ | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| Reception | 3 | ‚úÖ | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| System | 5 | ‚ùå | ‚ö†Ô∏è Mock –¥–∞–Ω–Ω—ã–µ |
| Files | 5 | ‚ùå | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| Licenses | 3 | ‚ùå | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |

### Frontend Pages

| –°—Ç—Ä–∞–Ω–∏—Ü–∞ | –°—Ç—Ä–æ–∫ | i18n | –°—Ç–∞—Ç—É—Å |
|----------|-------|------|--------|
| Login | 7597 | ‚úÖ | ‚úÖ –ì–æ—Ç–æ–≤–æ |
| Reception | 17907 | ‚úÖ | ‚úÖ –ì–æ—Ç–æ–≤–æ |
| Patients | 20103 | ‚úÖ | ‚úÖ –ì–æ—Ç–æ–≤–æ |
| Doctors | 28567 | ‚úÖ | ‚úÖ –ì–æ—Ç–æ–≤–æ |
| Finance | 19640 | ‚ö†Ô∏è | ‚úÖ –ì–æ—Ç–æ–≤–æ |
| Reports | 9928 | ‚úÖ | ‚úÖ –ì–æ—Ç–æ–≤–æ |
| System | 58211 | ‚ö†Ô∏è | ‚ö†Ô∏è –•–∞—Ä–¥–∫–æ–¥ |
| Archive | 6237 | ‚úÖ | ‚úÖ –ì–æ—Ç–æ–≤–æ |
| QueueTV | 6114 | ‚úÖ | ‚úÖ –ì–æ—Ç–æ–≤–æ |

---

## üõ†Ô∏è –ß–µ–∫-–ª–∏—Å—Ç –ü–µ—Ä–µ–¥ –ó–∞–ø—É—Å–∫–æ–º MVP

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ (P0)

- [x] ~~–î–æ–±–∞–≤–∏—Ç—å try-catch –≤ `setPrintSettings()`~~ ‚Üí –£–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç API!
- [x] ~~–û—Ç–∫–ª—é—á–∏—Ç—å –∫–Ω–æ–ø–∫—É "–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ"~~ ‚Üí i18n toast –¥–æ–±–∞–≤–ª–µ–Ω
- [x] ~~–î–æ–±–∞–≤–∏—Ç—å `.where(deleted_at.is_(None))` –≤ recent-transactions~~ ‚Üí ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö workflow –Ω–∞ staging

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è (P1)

- [x] ~~–ó–∞–º–µ–Ω–∏—Ç—å 5 —Ö–∞—Ä–¥–∫–æ–¥–æ–≤ –Ω–∞ `t('key')`~~ ‚Üí ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ System.tsx
- [x] ~~–í—ã–Ω–µ—Å—Ç–∏ MAX_TRANSACTION_AMOUNT –≤ .env~~ ‚Üí ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –≤ config.py
- [x] ~~–î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é service_id –≤ –æ—á–µ—Ä–µ–¥–∏~~ ‚Üí –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ä–∞—á–∞ (active + not deleted)
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ (P2)

- [ ] –ß–∞—Å—Ç–∏—á–Ω—ã–µ –≤–æ–∑–≤—Ä–∞—Ç—ã
- [ ] –ö–æ—Ä–∑–∏–Ω–∞ —É—Å–ª—É–≥
- [ ] E2E —Ç–µ—Å—Ç—ã Telegram
- [ ] –≠–∫—Å–ø–æ—Ä—Ç/–∏–º–ø–æ—Ä—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫

---

## üìã Workflow MVP

### 1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ç—É—Ä–∞
```
–ü–æ–∏—Å–∫ –ø–∞—Ü–∏–µ–Ω—Ç–∞ ‚Üí –í—ã–±–æ—Ä –≤—Ä–∞—á–∞ ‚Üí –í—ã–±–æ—Ä —É—Å–ª—É–≥–∏ ‚Üí –û–ø–ª–∞—Ç–∞ ‚Üí –ß–µ–∫ ‚Üí –û—á–µ—Ä–µ–¥—å
```
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞–µ—Ç

### 2. –ö–∞—Å—Å–∞
```
–û—Ç–∫—Ä—ã—Ç—å —Å–º–µ–Ω—É ‚Üí –ü—Ä–∏–Ω—è—Ç—å –æ–ø–ª–∞—Ç—É ‚Üí X-–æ—Ç—á—ë—Ç ‚Üí –ó–∞–∫—Ä—ã—Ç—å —Å–º–µ–Ω—É ‚Üí Z-–æ—Ç—á—ë—Ç
```
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞–µ—Ç

### 3. –í—Ä–∞—á–∏
```
–î–æ–±–∞–≤–∏—Ç—å –≤—Ä–∞—á–∞ ‚Üí –î–æ–±–∞–≤–∏—Ç—å —É—Å–ª—É–≥–∏ ‚Üí –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ü–µ–Ω—ã ‚Üí –ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å
```
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞–µ—Ç

### 4. –ü–∞—Ü–∏–µ–Ω—Ç—ã
```
–°–æ–∑–¥–∞—Ç—å ‚Üí –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å ‚Üí –ò—Å—Ç–æ—Ä–∏—è –ø–æ—Å–µ—â–µ–Ω–∏–π ‚Üí –§–∞–π–ª—ã ‚Üí –ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å
```
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞–µ—Ç

### 5. –°–∏—Å—Ç–µ–º–∞
```
–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–µ—á–∞—Ç–∏ ‚Üí –†–µ–∫–≤–∏–∑–∏—Ç—ã ‚Üí –õ–∏—Ü–µ–Ω–∑–∏—è ‚Üí –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
```
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ API (–Ω–µ localStorage)

---

## üéØ –ò—Ç–æ–≥–æ–≤–∞—è –û—Ü–µ–Ω–∫–∞

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –û—Ü–µ–Ω–∫–∞ | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|----------|--------|-------------|
| Backend API | 9/10 | –û—Ç–ª–∏—á–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, RBAC, –∞—É–¥–∏—Ç |
| Frontend UI | 8/10 | –ü–æ–ª–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª, –µ—Å—Ç—å —Ö–∞—Ä–¥–∫–æ–¥ |
| –§–∏–Ω–∞–Ω—Å—ã | 9/10 | Race-safe, idempotency, –∞—É–¥–∏—Ç |
| –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å | 8/10 | JWT, RBAC, rate limiting |
| –¢–µ—Å—Ç—ã | 6/10 | –ï—Å—Ç—å –æ—Å–Ω–æ–≤–Ω—ã–µ, –Ω–µ—Ç E2E |
| i18n | 7/10 | 95% –ø–æ–∫—Ä—ã—Ç–æ, –µ—Å—Ç—å –ø—Ä–æ–ø—É—Å–∫–∏ |
| –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è | 5/10 | –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è |

**–û–±—â–∞—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ MVP: 8.0/10** ‚úÖ

---

## ‚ö° –ë—ã—Å—Ç—Ä—ã–µ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (Copy-Paste)

### 1. Try-catch –¥–ª—è localStorage
```typescript
// frontend/src/utils/print.ts
export function setPrintSettings(next: PrintSettings) {
  try {
    localStorage.setItem(STORAGE_KEY, JSON.stringify(next));
  } catch (e) {
    console.error('Failed to save print settings:', e);
    // –ü–æ–∫–∞–∑–∞—Ç—å toast –µ—Å–ª–∏ –µ—Å—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç
  }
}
```

### 2. –§–∏–ª—å—Ç—Ä deleted –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö
```python
# backend/modules/finance/router.py:610
res = await db.execute(
    select(Transaction)
    .where(
        Transaction.shift_id == active_shift.id,
        Transaction.deleted_at.is_(None),  # –î–æ–±–∞–≤–∏—Ç—å!
    )
    .order_by(Transaction.created_at.desc())
    .limit(limit)
)
```

### 3. –û—Ç–∫–ª—é—á–∏—Ç—å –∫–Ω–æ–ø–∫—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
```typescript
// frontend/src/pages/System.tsx –≤ —Ä–∞–∑–¥–µ–ª–µ updates
<Button
  disabled={true}  // –ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞ true!
  onClick={handleInstallUpdate}
>
  {t('system.install_update')}
</Button>
```

---

## üîß –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ú–µ–ª–∫–∏–µ –ù–µ–¥–æ—Ä–∞–±–æ—Ç–∫–∏

### Frontend

| # | –§–∞–π–ª | –ü—Ä–æ–±–ª–µ–º–∞ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
|---|------|----------|-----------|
| 1 | System.tsx:286 | –•–∞—Ä–¥–∫–æ–¥ "–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã" | P1 |
| 2 | System.tsx:403 | –•–∞—Ä–¥–∫–æ–¥ "–£–¥–∞–ª–∏—Ç—å –ª–æ–≥–æ—Ç–∏–ø" | P1 |
| 3 | System.tsx:494 | –•–∞—Ä–¥–∫–æ–¥ "–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å QR" | P1 |
| 4 | System.tsx:525 | –•–∞—Ä–¥–∫–æ–¥ "–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ" | P1 |
| 5 | Finance.tsx:151 | –•–∞—Ä–¥–∫–æ–¥ "Failed to check" | P1 |
| 6 | print.ts:53 | –ù–µ—Ç try-catch | P0 |
| 7 | Patients.tsx | –ë–æ–ª—å—à–æ–π —Ñ–∞–π–ª (600 —Å—Ç—Ä–æ–∫) | P2 |

### Backend

| # | –§–∞–π–ª | –ü—Ä–æ–±–ª–µ–º–∞ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
|---|------|----------|-----------|
| 1 | finance/router.py:247 | –•–∞—Ä–¥–∫–æ–¥ –ª–∏–º–∏—Ç–∞ 10M | P1 |
| 2 | finance/router.py:610 | –ù–µ—Ç —Ñ–∏–ª—å—Ç—Ä–∞ deleted_at | P1 |
| 3 | system/router.py | Mock update-check | P0 |
| 4 | reception/router.py | –ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ service_id | P1 |
| 5 | doctors/router.py:99 | –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ require_roles | P2 |

### –ë–∞–∑–∞ –î–∞–Ω–Ω—ã—Ö

| # | –ü—Ä–æ–±–ª–µ–º–∞ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
|---|----------|-----------|
| 1 | –ù–µ—Ç –∏–Ω–¥–µ–∫—Å–∞ –Ω–∞ Transaction.idempotency_key | P1 |
| 2 | –ù–µ—Ç constraint unique –Ω–∞ –æ–¥–Ω—É –∞–∫—Ç–∏–≤–Ω—É—é —Å–º–µ–Ω—É | P2 |

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã –ü–æ–¥–¥–µ—Ä–∂–∫–∏

–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å MVP:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: `backend/*.log`
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏: `alembic current`

---

**‚úÖ –ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ MVP —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –¥–æ—Ä–∞–±–æ—Ç–∫–∞–º–∏!**
