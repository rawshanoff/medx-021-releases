---
description: Лицензирование/ключи: RS256, хранение, выдача через бот, безопасность
globs: "{backend/core/licenses.py,license_server/**/*.py,*.pem,*.key,license.key}"
alwaysApply: false
---

# Лицензирование и ключи

- **RS256**: приватный ключ хранится только локально/в секрете, публичный ключ можно в дистрибутиве/конфиге.
- **Никогда не коммитим**: `private_key.pem`, `license.key`, `*.key`, `*.pem`, `.env`.
- **ADMIN_TOKEN**: обязателен, длинный случайный, не дефолтный.
- **Fail-closed**: если подпись/ключ/даты фич невалидны — фича считается выключенной.
- **Аудит выдач** (Enterprise): выдача/продление/отзыв должны записываться (реестр + лог).
