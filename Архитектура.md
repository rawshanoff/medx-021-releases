# 🏥 Проектирование системы для медицинской клиники

---

## 📋 Структура MVP (Минимальный продукт)

### Основные модули

```
┌─────────────────────────────────────────────────────────────┐
│                    АРХИТЕКТУРА MVP                         │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐   │
│  │Пациенты  │  │  Очередь │  │  Касса   │  │  Отчёты  │   │
│  └────┬─────┘  └────┬─────┘  └────┬─────┘  └────┬─────┘   │
│       │             │             │             │          │
│       └─────────────┴──────┬──────┴─────────────┘          │
│                            │                               │
│                    ┌───────┴───────┐                       │
│                    │   База данных │                       │
│                    └───────┬───────┘                       │
│                            │                               │
│                    ┌───────┴───────┐                       │
│                    │ Telegram Bot  │                       │
│                    │   (админ)     │                       │
│                    └───────────────┘                       │
└─────────────────────────────────────────────────────────────┘
```

---

## 🎯 MVP — Полный список функций

### 1. 👥 Модуль «Пациенты»

```
БАЗОВЫЕ (ты уже учёл):
├── Регистрация нового пациента
├── Поиск пациента (ФИО, телефон, ID)
├── Редактирование данных
└── Просмотр истории визитов

ДОБАВИТЬ В MVP:
├── 📱 Уникальный ID пациента (для быстрого поиска)
├── 📸 Фото пациента (опционально, для идентификации)
├── 📋 Категория пациента (обычный, VIP, сотрудник, льготник)
├── 💳 Баланс пациента (депозит/долг)
├── 📝 Примечания (аллергии, особенности)
├── 🔗 Связь родственников (ребёнок → родитель)
├── 📊 Источник прихода (реклама, рекомендация, повторный)
└── ❌ Чёрный список (с причиной)
```

### 2. 👨‍⚕️ Модуль «Врачи и Кабинеты»

```
СТРУКТУРА:
├── Врачи
│   ├── ФИО, специализация
│   ├── Расписание работы (дни, часы)
│   ├── Привязка к кабинетам
│   ├── Стоимость приёма (если отличается)
│   └── Статус (работает/не работает сегодня)
│
├── Кабинеты
│   ├── Номер/название (Кабинет 1, УЗИ, Лаборатория)
│   ├── Этаж/расположение
│   ├── Тип услуг
│   └── Оборудование
│
└── Услуги
    ├── Название
    ├── Категория (консультация, УЗИ, анализы, процедуры)
    ├── Цена (базовая)
    ├── Длительность (для записи)
    └── Привязка к врачу/кабинету
```

### 3. 📋 Модуль «Очередь и Запись»

```
БАЗОВЫЕ:
├── Выдача талона в живую очередь
├── Предварительная запись на время
├── Просмотр очереди
└── Вызов следующего

ДОБАВИТЬ В MVP:
├── 🎫 Два типа очереди:
│   ├── Живая (пришёл → взял талон → ждёшь)
│   └── По записи (забронировал время)
│
├── 📊 Статусы визита:
│   ├── Зарегистрирован
│   ├── Ожидает
│   ├── В кабинете
│   ├── Завершён
│   ├── Не явился
│   └── Отменён
│
├── ⏱️ Учёт времени:
│   ├── Время регистрации
│   ├── Время вызова
│   ├── Время завершения
│   └── Время ожидания (для статистики!)
│
├── 🔄 Переназначение:
│   ├── Перенос к другому врачу
│   ├── Перенос на другое время
│   └── История изменений
│
└── ⚡ Приоритеты:
    ├── Обычный
    ├── Срочный
    └── VIP
```

### 4. 💰 Модуль «Касса»

```
БАЗОВЫЕ:
├── Приём оплаты (наличные, карта)
├── Печать чека (не фискальный)
└── Учёт денег

ДОБАВИТЬ В MVP:
├── 💵 Способы оплаты:
│   ├── Наличные
│   ├── Карта (терминал)
│   ├── Перевод
│   ├── Депозит (с баланса пациента)
│   └── Смешанная оплата
│
├── 🧾 Операции:
│   ├── Продажа услуги
│   ├── Пополнение депозита
│   ├── Возврат (полный/частичный)
│   ├── Внесение наличных
│   └── Изъятие наличных
│
├── 📦 Смена кассира:
│   ├── Открытие смены
│   ├── Закрытие смены
│   ├── X-отчёт (промежуточный)
│   ├── Z-отчёт (закрытие)
│   └── Сверка кассы
│
├── 🏷️ Скидки:
│   ├── Процент/фиксированная сумма
│   ├── Скидка на услугу
│   ├── Скидка на чек
│   ├── Промокоды
│   └── Скидка по категории пациента
│
├── 📄 Чек:
│   ├── Номер чека
│   ├── Дата/время
│   ├── Пациент
│   ├── Список услуг
│   ├── Скидки
│   ├── Итого
│   ├── Способ оплаты
│   ├── Номер в очереди
│   ├── Кабинет
│   └── QR-код (ссылка на бота)
│
└── 🔐 Безопасность:
    ├── Причина возврата (обязательно)
    ├── Подтверждение отмены
    └── Журнал всех операций
```

### 5. 📊 Модуль «Отчёты и Дашборд»

```
ДАШБОРД (главный экран):
├── 📈 Сегодня:
│   ├── Выручка (нал/безнал)
│   ├── Количество пациентов
│   ├── Средний чек
│   ├── Очередь сейчас
│   └── Загрузка врачей
│
├── 📊 Графики:
│   ├── Выручка по дням/неделям
│   ├── Популярные услуги
│   └── Динамика посещений

ОТЧЁТЫ:
├── 💰 Финансовые:
│   ├── Выручка за период
│   ├── По способам оплаты
│   ├── По услугам
│   ├── По врачам
│   ├── Средний чек
│   ├── Возвраты
│   └── Скидки (потери)
│
├── 👥 По пациентам:
│   ├── Новые за период
│   ├── Повторные
│   ├── Должники
│   ├── С депозитом
│   └── По источникам прихода
│
├── 👨‍⚕️ По врачам:
│   ├── Количество приёмов
│   ├── Выручка
│   ├── Среднее время приёма
│   └── Загруженность
│
├── ⏱️ Операционные:
│   ├── Среднее время ожидания
│   ├── Пиковые часы
│   ├── % неявок
│   └── % отмен
│
└── 📤 Экспорт:
    ├── Excel
    ├── PDF
    └── Telegram
```

### 6. 🤖 Telegram Bot (для администрации)

```
КОМАНДЫ:
├── /today — статистика сегодня
├── /week — за неделю
├── /month — за месяц
├── /queue — текущая очередь
├── /doctors — статус врачей
├── /cash — касса сейчас
└── /report — полный отчёт

УВЕДОМЛЕНИЯ:
├── 🔔 Открытие/закрытие смены
├── 💰 Крупные оплаты (> X сумма)
├── ❌ Возвраты
├── ⚠️ Долгое ожидание пациента
├── 📊 Ежедневный отчёт (вечером)
└── 🚨 Подозрительные операции
```

### 7. 👤 Модуль «Пользователи и Права»

```
РОЛИ:
├── 👑 Администратор (владелец)
│   └── Полный доступ
│
├── 👨‍💼 Менеджер
│   ├── Отчёты
│   ├── Настройки
│   └── Без удаления
│
├── 💁 Регистратор
│   ├── Пациенты
│   ├── Очередь
│   └── Касса
│
└── 👨‍⚕️ Врач (если нужен доступ)
    └── Только своя очередь

БЕЗОПАСНОСТЬ:
├── Логин/пароль
├── Журнал входов
├── Журнал действий (аудит)
└── Автовыход (таймаут)
```

---

## 🚀 Enterprise — Расширенные функции

### 1. 📺 Система отображения очереди

```
МОНИТОРЫ:
├── В холле:
│   ├── Общая очередь
│   ├── Вызов: "А-015 → Кабинет 3"
│   ├── Звуковое оповещение
│   └── Бегущая строка (акции)
│
├── У кабинета:
│   ├── Номер кабинета
│   ├── Имя врача
│   ├── Текущий пациент
│   └── Следующие 3 в очереди
│
└── Для врача:
    ├── Список его пациентов
    ├── Кнопка "Следующий"
    └── Информация о пациенте
```

### 2. 🤖 Telegram Bot (для пациентов)

```
ФУНКЦИИ:
├── 📝 Регистрация (привязка к профилю)
├── 📅 Запись на приём:
│   ├── Выбор врача/услуги
│   ├── Выбор даты/времени
│   └── Подтверждение
│
├── 📋 Мои записи:
│   ├── Предстоящие
│   ├── История
│   └── Отмена записи
│
├── 🎫 Живая очередь:
│   ├── Взять талон (если у клиники)
│   ├── Мой номер
│   ├── Сколько впереди
│   └── Примерное время
│
├── 🔔 Уведомления:
│   ├── Напоминание (за день, за час)
│   ├── "Ваша очередь через 2 человека"
│   ├── "Вас вызывают в кабинет X"
│   └── Результаты готовы
│
├── 💳 Финансы:
│   ├── Мой баланс
│   ├── История оплат
│   └── Онлайн оплата (опционально)
│
└── 📄 Документы:
    ├── Результаты анализов
    ├── Заключения УЗИ
    └── Справки
```

### 3. 📋 Электронная медкарта

```
ФУНКЦИИ:
├── История посещений
├── Диагнозы
├── Назначения
├── Результаты исследований:
│   ├── Анализы
│   ├── УЗИ (с изображениями)
│   ├── Рентген
│   └── Заключения
├── Шаблоны для врачей
├── Печать справок/выписок
└── Экспорт карты пациенту
```

### 4. 💼 Расширенные финансы

```
ЗАРПЛАТА ВРАЧЕЙ:
├── Процент от услуг
├── Фикс + процент
├── По категориям услуг
├── Расчёт за период
└── Ведомость

РАСХОДЫ КЛИНИКИ:
├── Категории расходов
├── Учёт закупок
├── Аренда, коммуналка
└── Зарплаты

P&L ОТЧЁТЫ:
├── Доходы
├── Расходы
├── Прибыль
├── По месяцам
└── Сравнение периодов
```

### 5. 📣 CRM и Маркетинг

```
ФУНКЦИИ:
├── 📞 Напоминания о визитах:
│   ├── "Вы не были 6 месяцев"
│   ├── Рекомендуемые осмотры
│   └── Автозвонок/SMS/Telegram
│
├── 📧 Рассылки:
│   ├── Акции
│   ├── Новые услуги
│   └── Поздравления (ДР)
│
├── ⭐ Отзывы:
│   ├── Запрос после визита
│   ├── Оценка врача/клиники
│   └── Обработка негатива
│
├── 🎁 Программа лояльности:
│   ├── Накопительные баллы
│   ├── Скидка постоянным
│   └── Приведи друга
│
└── 📊 Аналитика источников:
    ├── Откуда пришёл
    ├── ROI рекламы
    └── Конверсия
```

### 6. 🔗 Интеграции

```
├── 💳 Платёжные системы (онлайн оплата)
├── 🧾 Фискализация (ОФД)
├── 🔬 Лаборатории (получение результатов)
├── 📱 SMS-шлюзы
├── 📞 IP-телефония (звонки)
├── 📆 Google/Яндекс Календарь
├── 1С (бухгалтерия)
└── BI системы (аналитика)
```

---

## 🗂️ Рекомендуемая база данных (структура)

```
ОСНОВНЫЕ ТАБЛИЦЫ:

patients (пациенты)
├── id, full_name, phone, telegram_id
├── birth_date, gender, address
├── category, balance, notes
├── source, created_at
└── is_blacklisted

doctors (врачи)
├── id, full_name, specialization
├── cabinet_id, schedule
└── is_active

cabinets (кабинеты)
├── id, name, floor
└── type

services (услуги)
├── id, name, category
├── price, duration
└── doctor_id, cabinet_id

visits (визиты/очередь)
├── id, patient_id, doctor_id
├── service_id, status
├── queue_number, scheduled_time
├── called_at, completed_at
└── priority

payments (платежи)
├── id, visit_id, patient_id
├── amount, payment_method
├── discount, cashier_id
└── receipt_number, created_at

users (пользователи системы)
├── id, login, password_hash
├── role, full_name
└── is_active

audit_log (журнал действий)
├── id, user_id, action
├── entity, entity_id
├── old_value, new_value
└── created_at
```

---

## 🛠️ Технический стек (рекомендация)

```
MVP:
├── Backend: Python (FastAPI) или Node.js
├── Frontend: React / Vue.js
├── База: PostgreSQL
├── Кэш: Redis (очередь)
├── Бот: python-telegram-bot / aiogram
└── Чеки: ESC/POS принтер

Enterprise:
├── + WebSocket (реалтайм очередь)
├── + Мониторы: Electron / веб-страница
├── + Файлы: S3/MinIO
└── + Очереди: RabbitMQ/Celery
```

---

## 📝 Приоритеты разработки MVP

```
ФАЗА 1 (Ядро) — 3-4 недели:
├── ✅ Пациенты (CRUD)
├── ✅ Врачи, кабинеты, услуги
├── ✅ Простая очередь
└── ✅ Базовая оплата

ФАЗА 2 (Деньги) — 2-3 недели:
├── ✅ Полноценная касса
├── ✅ Смены
├── ✅ Чеки
└── ✅ Скидки

ФАЗА 3 (Отчёты) — 2 недели:
├── ✅ Дашборд
├── ✅ Основные отчёты
└── ✅ Экспорт

ФАЗА 4 (Бот) — 1-2 недели:
├── ✅ Telegram бот админа
└── ✅ Уведомления
```

---

## 💡 Мои рекомендации (если бы это была моя клиника)

### Критически важно в MVP:
1. **Быстрый поиск пациента** — регистратор не должен ждать
2. **Простой интерфейс** — обучение за 1 день
3. **Надёжность** — офлайн режим если интернет упал
4. **Аудит всего** — кто что сделал (защита от споров)
5. **Баланс пациента** — удобно для постоянных

### Что окупается быстро:
1. **Учёт источников** → понимание какая реклама работает
2. **Время ожидания** → оптимизация процессов
3. **Telegram бот для владельца** → контроль без присутствия
4. **Скидки с учётом** → видно сколько теряете

---

Хочешь, чтобы я детализировал какой-то конкретный модуль? Или показал примеры экранов/API?